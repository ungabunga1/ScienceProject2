I made some changes to this library